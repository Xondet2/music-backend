<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>üéµ Reproductor de M√∫sica</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<body class="container mt-4">
    <h1 class="mb-4">üéµ Reproductor de M√∫sica</h1>

    <!-- Buscador -->
    <form method="get" class="mb-3">
        <input type="text" name="q" placeholder="Buscar canci√≥n" class="form-control" value="{{ query }}">
    </form>

    <h3>üåç Resultados en iTunes</h3>
    <div class="list-group mb-4">
        {% for c in canciones_api %}
        <div class="list-group-item">
            <img src="{{ c.cover }}" alt="cover" style="width:50px; height:50px; margin-right:10px;">
            <strong>{{ c.titulo }}</strong> - {{ c.artista }}
            {% if c.preview %}
            <audio controls class="mt-2">
                <source src="{{ c.preview }}" type="audio/mpeg">
            </audio>
            {% endif %}
        </div>
        {% empty %}
        <p>No hay resultados de iTunes.</p>
        {% endfor %}
    </div>

    <h3>üíæ Canciones Locales</h3>
    <!-- Subida de canciones -->
    <form method="post" action="{% url 'add_song' %}" enctype="multipart/form-data" class="mb-4">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-success">‚ûï Agregar Canci√≥n</button>
    </form>

    <div class="list-group">
        {% for c in canciones_locales %}
        <div class="list-group-item">
            <strong>{{ c.titulo }}</strong> - {{ c.artista }}
            {% if c.archivo %}
            <audio controls class="mt-2">
                <source src="{{ c.archivo.url }}" type="audio/mpeg">
            </audio>
            {% else %}
            <a class="btn btn-primary btn-sm mt-2" href="{% url 'play_song' c.id %}">‚ñ∂ Reproducir</a>
            {% endif %}
        </div>
        {% empty %}
        <p>No hay canciones locales guardadas.</p>
        {% endfor %}
    </div>
</body>

</html>